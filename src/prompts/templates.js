/**
 * AI Prompt æ¨¡æ¿ - åŸºäºæœ¬ä½“è®ºï¼ˆOntologyï¼‰å’ŒçŸ¥è¯†å›¾è°±æœ€ä½³å®è·µ
 */

/**
 * é¦–æ¬¡æœ¬ä½“æ„å»ºçš„Promptæ¨¡æ¿
 */
export const BUILD_ONTOLOGY_PROMPT = `ä½ æ˜¯ä¸€ä¸ªçŸ¥è¯†æœ¬ä½“ï¼ˆOntologyï¼‰æ„å»ºä¸“å®¶ï¼Œç²¾é€šå›¾æ•°æ®åº“ã€çŸ¥è¯†å›¾è°±å’Œè¯­ä¹‰ç½‘æŠ€æœ¯ã€‚

# ä»»åŠ¡ç›®æ ‡
ä»ç”¨æˆ·æä¾›çš„èµ„è®¯å†…å®¹ä¸­ï¼Œæ„å»ºä¸€ä¸ªç»“æ„åŒ–çš„çŸ¥è¯†æœ¬ä½“ã€‚

# æœ¬ä½“è®ºæ ¸å¿ƒåŸåˆ™

## 1. å±‚æ¬¡æ€§ï¼ˆHierarchical Structureï¼‰
- è¯†åˆ«ä¸åŒ**æŠ½è±¡å±‚æ¬¡**çš„æ¦‚å¿µ
- ä»å…·ä½“åˆ°æŠ½è±¡ç»„ç»‡æ¦‚å¿µ
- å»ºç«‹ä¸Šä¸‹ä½å…³ç³»ï¼ˆClasses å’Œ Subclassesï¼‰

ç¤ºä¾‹å±‚æ¬¡ï¼š
- ç¬¬ä¸€å±‚ï¼šå…·ä½“å®ä½“/è¡Œä¸ºä½“ï¼ˆWho/Whatï¼‰
- ç¬¬äºŒå±‚ï¼šäº’åŠ¨å…³ç³»/è¿‡ç¨‹ï¼ˆHowï¼‰
- ç¬¬ä¸‰å±‚ï¼šç³»ç»Ÿ/åœºåŸŸï¼ˆWhereï¼‰
- ç¬¬å››å±‚ï¼šçŠ¶æ€/æŒ‡æ ‡ï¼ˆStatusï¼‰
- ç¬¬äº”å±‚ï¼šè¶‹åŠ¿/è§„å¾‹ï¼ˆWhy/Futureï¼‰

## 2. è¯­ä¹‰ä¸°å¯Œæ€§ï¼ˆSemantic Richnessï¼‰
å…³ç³»ä¸åº”ä»…æ˜¯"å…³è”"ï¼Œè€Œåº”ä½¿ç”¨**æ˜ç¡®çš„è¯­ä¹‰åŠ¨è¯**ï¼š

### ç»“æ„å…³ç³»
- is-aï¼ˆæ˜¯ä¸€ä¸ªï¼‰ï¼šç±»åˆ«å½’å±
- part-ofï¼ˆéƒ¨åˆ†-æ•´ä½“ï¼‰ï¼šç»„æˆå…³ç³»
- has-aï¼ˆæ‹¥æœ‰ï¼‰ï¼šå±æ€§å…³ç³»

### è¡Œä¸ºå…³ç³»
- producesï¼ˆäº§ç”Ÿï¼‰
- influencesï¼ˆå½±å“ï¼‰
- triggersï¼ˆè§¦å‘ï¼‰
- transformsï¼ˆè½¬åŒ–ï¼‰
- regulatesï¼ˆè°ƒèŠ‚ï¼‰

### æ—¶ç©ºå…³ç³»
- occurs-inï¼ˆå‘ç”Ÿäºï¼‰
- precedesï¼ˆå…ˆäºï¼‰
- followsï¼ˆåäºï¼‰
- co-occursï¼ˆå…±ç°ï¼‰

### é€»è¾‘å…³ç³»
- causesï¼ˆå¯¼è‡´ï¼‰
- enablesï¼ˆä½¿èƒ½ï¼‰
- constrainsï¼ˆçº¦æŸï¼‰
- contradictsï¼ˆçŸ›ç›¾ï¼‰

## 3. ç³»ç»Ÿæ€§ï¼ˆSystemic Viewï¼‰
- è¯†åˆ«**åé¦ˆå¾ªç¯**
- æ„å»º**é—­ç¯ç³»ç»Ÿ**
- ä½“ç°**æ¶Œç°ç‰¹æ€§**

# ç”¨æˆ·è¾“å…¥å†…å®¹
{content}

# è¾“å‡ºæ ¼å¼ï¼ˆä¸¥æ ¼JSONï¼‰

{
  "nodes": [
    {
      "id": "node-1",
      "name": "æ¦‚å¿µåç§°",
      "type": "concept_type",
      "layer": 1,
      "description": "æ¸…æ™°çš„æ¦‚å¿µå®šä¹‰",
      "properties": {
        "abstract_level": "concrete|intermediate|abstract",
        "domain": "é¢†åŸŸæ ‡ç­¾"
      }
    }
  ],
  "edges": [
    {
      "id": "edge-1",
      "source": "node-1",
      "target": "node-2",
      "relation": "å…·ä½“è¯­ä¹‰åŠ¨è¯",
      "relation_type": "structural|behavioral|temporal|logical",
      "description": "å…³ç³»çš„è¯¦ç»†è¯´æ˜",
      "strength": "strong|medium|weak"
    }
  ],
  "metadata": {
    "layers": ["ç¬¬ä¸€å±‚æè¿°", "ç¬¬äºŒå±‚æè¿°", ...],
    "core_concepts": ["æ ¸å¿ƒæ¦‚å¿µ1", "æ ¸å¿ƒæ¦‚å¿µ2"],
    "system_loops": ["è¯†åˆ«åˆ°çš„åé¦ˆå¾ªç¯æè¿°"]
  }
}

# è´¨é‡è¦æ±‚

1. **æ¦‚å¿µæ•°é‡**ï¼š5-20ä¸ªæ ¸å¿ƒæ¦‚å¿µï¼ˆé¿å…è¿‡åº¦ç»†åˆ†ï¼‰
2. **å±‚æ¬¡æ¸…æ™°**ï¼šè‡³å°‘2-3ä¸ªæŠ½è±¡å±‚æ¬¡
3. **å…³ç³»æ˜ç¡®**ï¼šæ¯ä¸ªå…³ç³»å¿…é¡»æœ‰æ¸…æ™°çš„è¯­ä¹‰
4. **ç³»ç»Ÿå®Œæ•´**ï¼šä½“ç°æ¦‚å¿µé—´çš„ç›¸äº’ä½œç”¨
5. **å¯æ¨ç†æ€§**ï¼šæ”¯æŒé€»è¾‘æ¨å¯¼å’ŒçŸ¥è¯†å‘ç°

# æ³¨æ„äº‹é¡¹
- IDä½¿ç”¨å°å†™å­—æ¯å’Œè¿å­—ç¬¦ï¼ˆå¦‚ï¼šconcept-finance-marketï¼‰
- å…³ç³»åŠ¨è¯ä½¿ç”¨ä¸­æ–‡ï¼Œç®€æ´æœ‰åŠ›
- ä¼˜å…ˆè¯†åˆ«ç³»ç»Ÿæ€§ç»“æ„ï¼Œè€Œéç½—åˆ—å­¤ç«‹æ¦‚å¿µ
- åªè¿”å›JSONï¼Œä¸è¦å…¶ä»–è¯´æ˜æ–‡å­—`;

/**
 * æœ¬ä½“æ›´æ–°çš„Promptæ¨¡æ¿
 */
export const UPDATE_ONTOLOGY_PROMPT = `ä½ æ˜¯ä¸€ä¸ªçŸ¥è¯†æœ¬ä½“èåˆä¸“å®¶ï¼Œæ“…é•¿å°†æ–°çŸ¥è¯†æ•´åˆåˆ°ç°æœ‰æœ¬ä½“ä¸­ã€‚

# ç°æœ‰æœ¬ä½“ç»“æ„
{existingOntology}

# æ–°è¾“å…¥çš„èµ„è®¯å†…å®¹
{content}

# èåˆä»»åŠ¡

## 1. åˆ†æå…³è”
- è¯†åˆ«æ–°å†…å®¹ä¸ç°æœ‰æœ¬ä½“çš„**è¯­ä¹‰å…³è”**
- åˆ¤æ–­æ–°æ¦‚å¿µæ‰€å±çš„**æŠ½è±¡å±‚æ¬¡**
- å‘ç°**è·¨å±‚æ¬¡çš„å…³ç³»**

## 2. æ¦‚å¿µå¤„ç†

### æ–°å¢æ¦‚å¿µ
- ç¡®å®šåœ¨æœ¬ä½“å±‚æ¬¡ä¸­çš„ä½ç½®
- å»ºç«‹ä¸ç°æœ‰æ¦‚å¿µçš„å…³ç³»
- è¡¥å……ç³»ç»Ÿæ€§è¿æ¥

### ç°æœ‰æ¦‚å¿µ
- ä¸°å¯Œæ¦‚å¿µå®šä¹‰
- å¢å¼ºæ¦‚å¿µå±æ€§
- å‘ç°æ–°çš„å…³ç³»

### å†—ä½™æ¦‚å¿µ
- è¯†åˆ«è¯­ä¹‰é‡å¤
- è¿›è¡Œæ¦‚å¿µåˆå¹¶
- ä¿æŒæœ¬ä½“ç®€æ´

## 3. å…³ç³»ä¼˜åŒ–
- è¯†åˆ«**éšå«å…³ç³»**ï¼ˆåŸºäºç°æœ‰å…³ç³»æ¨å¯¼ï¼‰
- å‘ç°**åé¦ˆå¾ªç¯**
- å¼ºåŒ–**ç³»ç»Ÿé—­ç¯**

# è¾“å‡ºæ ¼å¼ï¼ˆä¸¥æ ¼JSONï¼‰

{
  "nodes": [...å®Œæ•´çš„èŠ‚ç‚¹åˆ—è¡¨ï¼ŒåŒ…å«æ–°æ—§èŠ‚ç‚¹...],
  "edges": [...å®Œæ•´çš„è¾¹åˆ—è¡¨ï¼ŒåŒ…å«æ–°æ—§å…³ç³»...],
  "metadata": {
    "layers": [...],
    "core_concepts": [...],
    "system_loops": [...]
  },
  "changes": {
    "added_nodes": ["æ–°å¢èŠ‚ç‚¹ID1", "æ–°å¢èŠ‚ç‚¹ID2"],
    "added_edges": ["æ–°å¢è¾¹ID1", "æ–°å¢è¾¹ID2"],
    "removed_nodes": ["ç§»é™¤çš„å†—ä½™èŠ‚ç‚¹IDï¼ˆå¦‚æœ‰ï¼‰"],
    "removed_edges": ["ç§»é™¤çš„å†—ä½™å…³ç³»IDï¼ˆå¦‚æœ‰ï¼‰"],
    "modified_nodes": ["ä¿®æ”¹çš„èŠ‚ç‚¹IDï¼ˆå¦‚æœ‰ï¼‰"],
    "insights": [
      "å‘ç°çš„æ–°ç³»ç»Ÿæ€§å…³è”1",
      "å‘ç°çš„æ–°åé¦ˆå¾ªç¯2"
    ]
  }
}

# èåˆåŸåˆ™
1. **ä¿æŒä¸€è‡´æ€§**ï¼šæ–°æ¦‚å¿µèå…¥ç°æœ‰å±‚æ¬¡ç»“æ„
2. **å¢å¼ºç³»ç»Ÿæ€§**ï¼šå‘ç°è·¨æ¦‚å¿µçš„ç³»ç»Ÿå…³è”
3. **é¿å…å†—ä½™**ï¼šåˆå¹¶è¯­ä¹‰é‡å¤çš„æ¦‚å¿µ
4. **ä¸°å¯Œè¯­ä¹‰**ï¼šä½¿ç”¨æ›´ç²¾ç¡®çš„å…³ç³»åŠ¨è¯
5. **å¯è¿½æº¯æ€§**ï¼šåœ¨changesä¸­æ¸…æ™°è¯´æ˜å˜æ›´

åªè¿”å›JSONï¼Œä¸è¦å…¶ä»–æ–‡å­—ã€‚`;

/**
 * å†…å®¹æ•´ç†çš„Promptæ¨¡æ¿
 */
export const FORMAT_CONTENT_PROMPT = `ä½ æ˜¯ä¸€ä¸ªåŸºäºæœ¬ä½“çš„å†…å®¹ç»“æ„åŒ–ä¸“å®¶ã€‚

# æœ¬ä½“ç»“æ„
{ontology}

# åŸå§‹èµ„è®¯å†…å®¹
{content}

# ä»»åŠ¡ç›®æ ‡
åŸºäºæœ¬ä½“çš„**å±‚æ¬¡ç»“æ„**å’Œ**è¯­ä¹‰å…³ç³»**ï¼Œé‡æ–°ç»„ç»‡å’Œå‘ˆç°å†…å®¹ã€‚

# è¾“å‡ºæ ¼å¼ï¼ˆMarkdownï¼‰

## ğŸ¯ æ ¸å¿ƒæ´å¯Ÿ
[åŸºäºæœ¬ä½“çš„ç³»ç»Ÿæ€§æ€»ç»“ï¼Œ3-5å¥è¯]

## ğŸ“Š æ¦‚å¿µå›¾è°±

### ç¬¬ä¸€å±‚ï¼š[å±‚æ¬¡åç§°]
- **[æ¦‚å¿µ1]** ([ç±»å‹]): å®šä¹‰
- **[æ¦‚å¿µ2]** ([ç±»å‹]): å®šä¹‰

### ç¬¬äºŒå±‚ï¼š[å±‚æ¬¡åç§°]
- **[æ¦‚å¿µ3]** ([ç±»å‹]): å®šä¹‰

[...ç»§ç»­å…¶ä»–å±‚æ¬¡...]

## ğŸ”— å…³é”®å…³ç³»ç½‘ç»œ

### ç»“æ„å…³ç³»
- [æ¦‚å¿µA] --åŒ…å«--> [æ¦‚å¿µB]
- [æ¦‚å¿µC] --å±äº--> [æ¦‚å¿µD]

### è¡Œä¸ºå…³ç³»
- [æ¦‚å¿µE] --äº§ç”Ÿ--> [æ¦‚å¿µF]
- [æ¦‚å¿µG] --å½±å“--> [æ¦‚å¿µH]

### ç³»ç»Ÿå¾ªç¯
- [æ¦‚å¿µI] â†’ [æ¦‚å¿µJ] â†’ [æ¦‚å¿µK] â†’ [æ¦‚å¿µI] (å½¢æˆé—­ç¯)

## ğŸ’¡ ç³»ç»Ÿæ€§ç†è§£

### å±‚æ¬¡é€’è¿›
[è¯´æ˜ä»å…·ä½“åˆ°æŠ½è±¡çš„é€’è¿›é€»è¾‘]

### å› æœé“¾æ¡
[è¯´æ˜æ ¸å¿ƒå› æœå…³ç³»]

### åé¦ˆæœºåˆ¶
[è¯´æ˜è¯†åˆ«åˆ°çš„åé¦ˆå¾ªç¯åŠå…¶æ„ä¹‰]

## ğŸ“ è¯¦ç»†é˜è¿°
[åŸºäºæœ¬ä½“ç»“æ„ï¼Œè¯¦ç»†å±•å¼€åŸå§‹å†…å®¹ï¼Œä¿æŒå±‚æ¬¡æ¸…æ™°]

---

# æ ¼å¼è¦æ±‚
1. æ‰€æœ‰æ¦‚å¿µç”¨ **[æ¦‚å¿µå]** æ ‡è®°
2. å…³ç³»ä½¿ç”¨è¯­ä¹‰åŒ–åŠ¨è¯ï¼ˆä¸è¦ç”¨"å…³è”"ï¼‰
3. çªå‡º**ç³»ç»Ÿæ€§**å’Œ**å±‚æ¬¡æ€§**
4. ä½“ç°æœ¬ä½“çš„**ç»“æ„ç¾æ„Ÿ**

åªè¿”å›Markdownå†…å®¹ï¼Œä¸è¦JSONã€‚`;

/**
 * è·å–Promptæ¨¡æ¿
 * @param {string} type - æ¨¡æ¿ç±»å‹ï¼š'build' | 'update' | 'format'
 * @param {Object} params - æ¨¡æ¿å‚æ•°
 * @returns {string} å¡«å……åçš„Prompt
 */
export function getPromptTemplate(type, params) {
  let template = '';

  switch (type) {
    case 'build':
      template = BUILD_ONTOLOGY_PROMPT;
      break;
    case 'update':
      template = UPDATE_ONTOLOGY_PROMPT;
      if (params.existingOntology) {
        params.existingOntology = JSON.stringify(params.existingOntology, null, 2);
      }
      break;
    case 'format':
      template = FORMAT_CONTENT_PROMPT;
      if (params.ontology) {
        // æå–æœ¬ä½“çš„å±‚æ¬¡å’Œç»“æ„ä¿¡æ¯
        const ontologyStr = JSON.stringify(params.ontology, null, 2);
        params.ontology = ontologyStr;
      }
      break;
    default:
      throw new Error(`Unknown prompt type: ${type}`);
  }

  // æ›¿æ¢æ¨¡æ¿å˜é‡
  let result = template;
  for (const [key, value] of Object.entries(params)) {
    result = result.replace(`{${key}}`, value);
  }

  return result;
}

export default {
  BUILD_ONTOLOGY_PROMPT,
  UPDATE_ONTOLOGY_PROMPT,
  FORMAT_CONTENT_PROMPT,
  getPromptTemplate
};
