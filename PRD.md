# 产品需求文档 (PRD)
## 基于本体构建的智能资讯阅读系统

---

## 1. 产品概述

### 1.1 产品名称
Ontology Reading - 智能本体资讯阅读系统

### 1.2 产品定位
一个结合图数据库本体构建技术的智能资讯阅读工具，通过自动构建和维护领域知识本体，帮助用户更有效地组织、理解和吸收各领域的资讯内容。

### 1.3 核心价值主张
- **自动知识组织**：首次输入领域资讯时自动构建本体结构
- **智能信息整合**：基于本体结构整理和呈现信息，建立知识关联
- **持续学习优化**：复用和优化已有本体，实现知识积累
- **可视化编辑**：支持用户手动调整本体结构，个性化知识体系

### 1.4 目标用户
- 研究人员和学者
- 知识工作者
- 终身学习者
- 需要跟踪多个领域资讯的专业人士

---

## 2. 功能需求

### 2.1 核心功能模块

#### 2.1.1 内容输入和阅读模块

**功能描述**：类似对话式聊天界面，用户可以输入资讯内容并获得基于本体的智能整理。

**主要功能点**：

1. **资讯输入**
   - 文本输入框（支持多行）
   - 文件上传（支持 .txt, .md, .pdf, .docx）
   - URL 导入（自动抓取网页内容）
   - 批量导入

2. **领域识别**
   - 自动识别输入内容所属领域
   - 判断是否存在相关本体结构
   - 提示用户确认或选择领域分类

3. **本体自动构建**（首次输入）
   - 调用 AI 模型分析内容
   - 提取核心概念、实体、关系
   - 生成本体结构（节点和边）
   - 存储至图数据库

4. **本体融合与优化**（后续输入）
   - 匹配已有本体结构
   - 识别新概念和新关系
   - 更新扩展现有本体
   - 标记变更历史

5. **智能内容呈现**
   - 基于本体结构展示知识点
   - 高亮核心概念和关系
   - 显示概念间的关联路径
   - 提供结构化摘要

6. **对话历史**
   - 保存输入输出记录
   - 支持历史记录检索
   - 按领域/日期过滤

#### 2.1.2 本体构建与管理模块

**功能描述**：可视化展示和编辑本体结构，支持用户手动调整知识图谱。

**主要功能点**：

1. **本体可视化**
   - 图形化展示本体结构（节点-边图）
   - 支持缩放、拖拽、搜索
   - 不同类型节点的颜色区分
   - 关系类型标注

2. **本体编辑**
   - 添加/删除/修改节点
   - 添加/删除/修改关系边
   - 编辑节点属性（名称、描述、标签）
   - 编辑关系属性（类型、权重、方向）

3. **本体管理**
   - 本体列表视图（按领域分组）
   - 本体元信息（创建时间、更新时间、节点数、边数）
   - 本体导出（JSON、GraphML、RDF）
   - 本体导入
   - 本体合并
   - 本体删除

4. **版本控制**
   - 本体变更历史记录
   - 版本对比
   - 回滚到历史版本

5. **本体分析**
   - 核心节点识别（中心度分析）
   - 社区发现（聚类分析）
   - 路径查询（两个概念间的关联）
   - 统计信息仪表板

### 2.2 辅助功能

1. **用户账户系统**
   - 注册/登录/登出
   - 个人资料管理
   - 数据隔离（每个用户独立的本体空间）

2. **设置与配置**
   - AI 模型配置（模型名称、API Token）
   - 图数据库连接配置
   - 界面偏好设置（主题、语言）
   - 本体构建参数调整

3. **搜索功能**
   - 全文搜索历史资讯
   - 本体内概念搜索
   - 跨本体搜索

---

## 3. 用户故事

### 3.1 首次使用场景

**作为** 一名机器学习研究者
**我想** 输入一篇关于Transformer架构的论文摘要
**以便于** 系统自动为我构建一个机器学习领域的本体结构

**验收标准**：
- 系统能识别这是机器学习领域内容
- 自动提取关键概念（如：Transformer、Self-Attention、Encoder、Decoder等）
- 生成概念间的关系（如：Transformer包含Encoder、Self-Attention是核心机制）
- 以图形化方式展示本体结构
- 内容按本体结构整理呈现

### 3.2 持续使用场景

**作为** 用户
**我想** 在已有机器学习本体的基础上，输入关于BERT模型的新资讯
**以便于** 系统融合新知识到现有本体中

**验收标准**：
- 系统识别内容属于已有的机器学习领域
- 识别新概念BERT及其与Transformer的关系
- 更新本体结构，添加BERT节点并连接到Transformer
- 显示本体变更摘要
- 基于更新后的本体呈现内容

### 3.3 本体编辑场景

**作为** 用户
**我想** 手动调整自动生成的本体结构
**以便于** 让知识组织更符合我的理解

**验收标准**：
- 能在可视化界面中选中节点/边
- 能修改节点名称和属性
- 能添加系统未识别的概念关系
- 能删除错误的节点或关系
- 修改实时保存到图数据库
- 修改历史可追溯

---

## 4. 技术架构

### 4.1 整体架构

```
┌─────────────────────────────────────────────────────┐
│                   前端 (Frontend)                    │
│  ┌──────────────────┐  ┌──────────────────────────┐ │
│  │ 内容输入输出界面  │  │   本体可视化编辑界面      │ │
│  └──────────────────┘  └──────────────────────────┘ │
└─────────────────────────────────────────────────────┘
                          ↕ REST API
┌─────────────────────────────────────────────────────┐
│                   后端 (Backend)                     │
│  ┌──────────────────────────────────────────────┐   │
│  │           业务逻辑层 (Service Layer)          │   │
│  │  - 领域识别服务                               │   │
│  │  - 本体构建服务                               │   │
│  │  - 本体融合服务                               │   │
│  │  - 内容整理服务                               │   │
│  └──────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────┘
           ↕                    ↕                ↕
┌─────────────────┐  ┌─────────────────┐  ┌─────────────┐
│  AI 模型服务     │  │  图数据库        │  │  关系数据库  │
│  (LLM API)      │  │  (Neo4j/ArangoDB)│  │  (PostgreSQL)│
│  - 概念提取      │  │  - 本体存储      │  │  - 用户数据  │
│  - 关系识别      │  │  - 图查询        │  │  - 配置信息  │
│  - 领域分类      │  │                  │  │  - 历史记录  │
└─────────────────┘  └─────────────────┘  └─────────────┘
```

### 4.2 技术栈建议

**前端**：
- 框架：React / Vue.js
- 图可视化：D3.js / Cytoscape.js / vis.js
- UI 组件库：Ant Design / Material-UI
- 状态管理：Redux / Vuex / Pinia
- HTTP 客户端：Axios

**后端**：
- 框架：Node.js (Express/Nest.js) / Python (FastAPI/Django)
- API 风格：RESTful API
- 认证：JWT

**数据库**：
- 图数据库：Neo4j (推荐) / ArangoDB / Amazon Neptune
- 关系数据库：PostgreSQL / MySQL
- 缓存：Redis

**AI 集成**：
- OpenAI API (GPT-4)
- Anthropic Claude API
- 自托管模型 (可选)
- 参数配置化：`model_name`, `api_token`

**部署**：
- 容器化：Docker / Docker Compose
- 编排：Kubernetes (可选)
- 云服务：AWS / Azure / GCP

---

## 5. 数据模型

### 5.1 图数据库模型（本体存储）

**节点类型**：

1. **Ontology（本体）**
   - 属性：
     - `id`: UUID
     - `name`: 本体名称
     - `domain`: 领域标识
     - `user_id`: 所属用户
     - `created_at`: 创建时间
     - `updated_at`: 更新时间
     - `description`: 描述

2. **Concept（概念节点）**
   - 属性：
     - `id`: UUID
     - `name`: 概念名称
     - `type`: 概念类型（实体/属性/事件等）
     - `description`: 描述
     - `confidence`: 置信度（自动生成时的可信度）
     - `source`: 来源（auto/manual）
     - `created_at`: 创建时间

**关系类型**：

1. **CONTAINS** (本体包含概念)
   - 从：Ontology
   - 到：Concept

2. **RELATES_TO** (概念间关系)
   - 从：Concept
   - 到：Concept
   - 属性：
     - `relation_type`: 关系类型（is-a, part-of, causes, related-to等）
     - `weight`: 权重/强度
     - `bidirectional`: 是否双向
     - `description`: 关系描述

### 5.2 关系数据库模型

**User（用户表）**
```sql
CREATE TABLE users (
    id UUID PRIMARY KEY,
    username VARCHAR(50) UNIQUE NOT NULL,
    email VARCHAR(100) UNIQUE NOT NULL,
    password_hash VARCHAR(255) NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

**ContentHistory（内容历史表）**
```sql
CREATE TABLE content_history (
    id UUID PRIMARY KEY,
    user_id UUID REFERENCES users(id),
    ontology_id UUID NOT NULL,
    input_content TEXT NOT NULL,
    processed_output JSON,
    domain VARCHAR(100),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

**OntologyVersion（本体版本表）**
```sql
CREATE TABLE ontology_versions (
    id UUID PRIMARY KEY,
    ontology_id UUID NOT NULL,
    version_number INT NOT NULL,
    snapshot JSON NOT NULL,
    change_summary TEXT,
    created_by UUID REFERENCES users(id),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

**UserSettings（用户设置表）**
```sql
CREATE TABLE user_settings (
    user_id UUID PRIMARY KEY REFERENCES users(id),
    model_name VARCHAR(100),
    api_token_encrypted TEXT,
    graph_db_config JSON,
    ui_preferences JSON,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

---

## 6. AI 模型集成

### 6.1 配置参数

系统需要支持以下 AI 模型配置参数：

```json
{
  "model_config": {
    "provider": "openai | anthropic | custom",
    "model_name": "gpt-4 | claude-opus-4-6 | ...",
    "api_token": "sk-...",
    "api_endpoint": "https://api.openai.com/v1 (可选)",
    "temperature": 0.7,
    "max_tokens": 2000
  }
}
```

### 6.2 AI 调用场景

1. **领域识别**
   - 输入：用户提交的文本内容
   - 输出：领域分类标签，置信度

2. **概念提取**
   - 输入：文本内容
   - 输出：概念列表 `[{name, type, description}]`

3. **关系识别**
   - 输入：文本内容 + 已提取概念列表
   - 输出：关系列表 `[{from, to, relation_type, description}]`

4. **本体融合建议**
   - 输入：新内容 + 现有本体结构
   - 输出：融合建议（新增节点、新增关系、修改建议）

5. **内容整理**
   - 输入：原始内容 + 本体结构
   - 输出：结构化整理后的内容（markdown格式，带概念链接）

### 6.3 Prompt 设计原则

- 提供清晰的任务描述
- 包含输出格式示例（使用 JSON Schema）
- 支持少样本学习（Few-shot learning）
- 可配置化系统指令

---

## 7. 用户界面设计

### 7.1 页面结构

#### 主界面布局
```
┌─────────────────────────────────────────────────────┐
│  Header: Logo | 搜索框 | 用户菜单                     │
├──────────┬──────────────────────────────────────────┤
│          │                                          │
│  侧边栏   │            主内容区                       │
│          │                                          │
│  - 对话   │  [根据当前页面动态切换]                   │
│  - 本体   │  · 内容输入输出界面                       │
│  - 设置   │  · 本体可视化界面                        │
│          │  · 设置界面                              │
│          │                                          │
└──────────┴──────────────────────────────────────────┘
```

### 7.2 内容输入输出界面

**布局**：
- 左侧：对话历史列表（按会话分组）
- 中间：当前对话区域
  - 输入框（底部）
  - 消息流（滚动区域）
    - 用户消息（右对齐）
    - 系统响应（左对齐，带本体结构化内容）
- 右侧：当前本体预览（可折叠）

**交互**：
- 输入框支持拖拽文件上传
- 消息中的概念可点击，高亮显示在本体图中
- 首次输入时显示"正在构建本体"加载动画
- 后续输入显示"正在融合本体"提示

### 7.3 本体可视化编辑界面

**布局**：
- 顶部：工具栏
  - 缩放控制
  - 布局算法选择（力导向、层次、径向）
  - 导出/导入按钮
  - 版本历史
- 中间：画布区域（图可视化）
- 右侧：属性面板（选中节点/边时显示详情）
- 底部：迷你地图（可选）

**交互**：
- 点击节点显示详情和编辑选项
- 双击节点进入编辑模式
- 拖拽创建新关系
- 右键菜单（删除、添加关系等）
- 搜索框高亮匹配节点
- 支持框选多个节点

### 7.4 设置界面

**分类**：
1. **账户设置**：头像、用户名、邮箱、密码
2. **AI 模型配置**：模型选择、Token 输入、测试连接
3. **数据库配置**：图数据库连接（高级用户）
4. **界面偏好**：主题、语言、字体大小
5. **本体参数**：自动构建阈值、概念提取深度

---

## 8. 核心流程

### 8.1 首次输入流程

```
用户输入内容
    ↓
领域识别（AI）
    ↓
判断：是否存在该领域本体？
    ├─ 否 → 创建新本体
    │         ↓
    │      概念提取（AI）
    │         ↓
    │      关系识别（AI）
    │         ↓
    │      构建图结构
    │         ↓
    │      存储到图数据库
    │         ↓
    │      内容整理（AI）
    │         ↓
    │      展示结果
    │
    └─ 是 → [进入本体融合流程]
```

### 8.2 本体融合流程

```
用户输入内容（已有本体）
    ↓
加载现有本体结构
    ↓
概念提取（AI）
    ↓
匹配现有概念
    ├─ 新概念 → 添加到本体
    └─ 已存在 → 更新属性
    ↓
关系识别（AI）
    ↓
匹配现有关系
    ├─ 新关系 → 添加到本体
    └─ 已存在 → 增强权重
    ↓
更新图数据库
    ↓
记录版本变更
    ↓
内容整理（AI）
    ↓
展示结果（高亮变更）
```

### 8.3 手动编辑流程

```
用户进入本体编辑界面
    ↓
选择本体
    ↓
加载并可视化
    ↓
用户操作：
    ├─ 添加节点 → 验证 → 保存到DB
    ├─ 修改节点 → 验证 → 更新DB
    ├─ 删除节点 → 确认 → 删除DB（级联）
    ├─ 添加关系 → 验证 → 保存到DB
    ├─ 修改关系 → 验证 → 更新DB
    └─ 删除关系 → 确认 → 删除DB
    ↓
创建版本快照
    ↓
实时更新界面
```

---

## 9. 非功能性需求

### 9.1 性能要求

- **响应时间**：
  - 页面加载：< 2秒
  - AI 处理（单次）：< 10秒
  - 图查询：< 500ms
  - 图可视化渲染（< 500节点）：< 1秒

- **并发**：
  - 支持至少 100 并发用户

- **数据规模**：
  - 单用户本体数：无限制
  - 单本体节点数：< 10,000（建议分拆超大本体）
  - 单用户历史记录：< 100,000 条

### 9.2 安全性要求

- **认证与授权**：
  - 使用 JWT 进行用户认证
  - 基于角色的访问控制（RBAC）
  - 数据隔离（用户只能访问自己的数据）

- **数据安全**：
  - API Token 加密存储
  - HTTPS 通信
  - SQL 注入防护
  - XSS 防护

- **隐私保护**：
  - 用户数据不用于训练模型（明确声明）
  - 符合 GDPR / 数据保护法规
  - 提供数据导出和删除功能

### 9.3 可用性要求

- **系统可用性**：99% uptime
- **备份**：每日自动备份数据库
- **灾难恢复**：支持从备份恢复

### 9.4 可维护性要求

- 模块化设计，低耦合
- 完整的 API 文档
- 代码注释和开发文档
- 单元测试覆盖率 > 70%
- 集成测试覆盖核心流程

### 9.5 可扩展性要求

- 支持水平扩展（后端服务）
- 图数据库分片（未来）
- 支持插件机制（自定义本体构建策略）

### 9.6 兼容性要求

- **浏览器**：Chrome (最新), Firefox (最新), Safari (最新), Edge (最新)
- **屏幕分辨率**：最小 1280x720
- **移动端**：响应式设计（未来版本）

---

## 10. 开发计划

### 10.1 MVP（最小可行产品）范围

**第一阶段：核心功能**（4-6周）
- [ ] 用户注册/登录
- [ ] 基础内容输入界面
- [ ] AI 模型集成（概念提取 + 关系识别）
- [ ] 自动本体构建（首次输入）
- [ ] 图数据库集成（Neo4j）
- [ ] 简单本体可视化（只读）
- [ ] 结构化内容展示

**第二阶段：本体管理**（3-4周）
- [ ] 本体融合功能
- [ ] 本体编辑功能（增删改节点/关系）
- [ ] 本体列表管理
- [ ] 版本控制基础功能

**第三阶段：优化与完善**（2-3周）
- [ ] 性能优化（查询优化、缓存）
- [ ] UI/UX 改进
- [ ] 错误处理和用户反馈
- [ ] 基础文档

### 10.2 后续迭代方向

- 本体模板市场（预定义领域本体）
- 协作功能（多用户共享本体）
- 高级分析功能（路径分析、影响力分析）
- 移动端应用
- 浏览器插件（一键导入网页内容）
- 知识导出（生成思维导图、报告）

---

## 11. 风险与挑战

### 11.1 技术风险

1. **AI 模型准确性**
   - 风险：自动提取的概念和关系可能不准确
   - 缓解：提供手动编辑功能，允许用户纠正

2. **图数据库性能**
   - 风险：大规模本体查询可能变慢
   - 缓解：合理的索引设计，分页加载，节点数量限制

3. **AI API 成本**
   - 风险：频繁调用 API 成本高昂
   - 缓解：缓存策略，批量处理，用户自带 Token

### 11.2 产品风险

1. **用户学习成本**
   - 风险：本体概念对普通用户可能过于复杂
   - 缓解：友好的引导教程，隐藏复杂术语，提供默认配置

2. **价值感知**
   - 风险：用户可能不理解本体结构的价值
   - 缓解：清晰的案例展示，对比传统笔记的优势

### 11.3 业务风险

1. **市场竞争**
   - 已有知识管理工具（Notion, Obsidian, Roam Research）
   - 差异化：自动化本体构建，AI 驱动的知识组织

---

## 12. 成功指标

### 12.1 产品指标

- **用户指标**：
  - 月活跃用户数 (MAU)
  - 用户留存率（7日、30日）
  - 用户平均使用时长

- **功能指标**：
  - 平均每用户创建本体数
  - 平均每本体节点数
  - 手动编辑占比（反映自动生成质量）

- **质量指标**：
  - 系统错误率 < 1%
  - AI 处理成功率 > 95%
  - 用户满意度评分 > 4/5

### 12.2 业务指标

- 付费转化率（如有付费计划）
- 用户获取成本 (CAC)
- 用户生命周期价值 (LTV)

---

## 13. 附录

### 13.1 术语表

- **本体 (Ontology)**：形式化表示领域知识的结构，包含概念及其关系
- **概念 (Concept)**：本体中的基本单元，代表一个实体或思想
- **关系 (Relation)**：概念之间的语义连接
- **图数据库 (Graph Database)**：以图结构（节点和边）存储数据的数据库
- **领域 (Domain)**：特定的知识或主题范畴

### 13.2 参考资料

- Neo4j 官方文档：https://neo4j.com/docs/
- D3.js 图可视化：https://d3js.org/
- OpenAI API 文档：https://platform.openai.com/docs/
- 知识图谱最佳实践

### 13.3 配置示例

**AI 模型配置示例** (`config/model.example.json`):
```json
{
  "provider": "openai",
  "model_name": "gpt-4",
  "api_token": "YOUR_API_TOKEN_HERE",
  "temperature": 0.7,
  "max_tokens": 2000
}
```

**图数据库连接示例** (`config/neo4j.example.json`):
```json
{
  "uri": "bolt://localhost:7687",
  "username": "neo4j",
  "password": "YOUR_PASSWORD_HERE"
}
```

---

## 文档版本

- **版本**：1.0
- **创建日期**：2026-02-24
- **最后更新**：2026-02-24
- **作者**：产品团队
- **状态**：待评审

---

**下一步行动**：
1. 技术团队评审技术可行性
2. 设计团队制作交互原型
3. 确定开发排期和资源分配
4. 开始 MVP 第一阶段开发
